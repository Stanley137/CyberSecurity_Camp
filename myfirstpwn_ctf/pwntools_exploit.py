from pwn import *
context.log_level = 'DEBUG'

#p = process('./pwntools')
p = remote('140.110.112.213', 2116)
p.recvuntil(b')')
first_in = pack(0x79487ff, 32, 'little')
p.sendline(first_in)
p.recvline()
formula = p.recvuntil(b'?').decode()
if '+' in formula:
    formula = formula.split(' + ')
    a = int(formula[0].split('\n')[1])
    b = int(formula[1].split(' =')[0])
    c = a + b
    p.sendline(str(c).encode())
elif '-' in formula:
    formula = formula.split(' - ')
    a = int(formula[0].split('\n')[1])
    b = int(formula[1].split(' =')[0])
    c = a - b
    p.sendline(str(c).encode())
elif '*' in formula:
    formula = formula.split(' * ')
    a = int(formula[0].split('\n')[1])
    b = int(formula[1].split(' =')[0])
    c = a * b
    p.sendline(str(c).encode())
for i in range(999):
    formula = p.recvuntil(b'?').decode()
    if '+' in formula:
        formula = formula.split(' + ')
        a = int(formula[0])
        b = int(formula[1].split(' = ')[0])
        c = a + b
        p.sendline(str(c).encode())
    elif '-' in formula:
        formula = formula.split(' - ')
        a = int(formula[0])
        b = int(formula[1].split(' = ')[0])
        c = a - b
        p.sendline(str(c).encode())
    elif '*' in formula:
        formula = formula.split(' * ')
        a = int(formula[0])
        b = int(formula[1].split(' = ')[0])
        c = a * b
        p.sendline(str(c).encode())
p.interactive()